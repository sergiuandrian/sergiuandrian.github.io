
                      // run to insert data
//node seed_data mongodb://localhost:27017/libraryapp 

// var categories = [{ title: 'Fantasy', name: 'fantasy' },
// { title: 'Children', name: 'children' },
// { title: 'DetectiveStories', name: 'detectivestories' },
// { title: 'History', name: 'history' }];

// var authors = [{ name: 'Bill Gates' },
// { name: 'Walter Isaacson' },
// { name: 'Suzanne Collins' },
// { name: 'John Doe' },
// { name: 'Steven Sigal' },
// { name: 'Grigore Vieru' }];

// var books = [{
//     id: 1,
//     title: 'Road Ahead',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'fant1.jpg'
// },
// {
//     id: 2,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book  about a great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'fant2.jpg'
// },
// {
//     id: 3,
//     title: 'Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about  great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'fant3.jpg'
// },
// {
//     id: 4,
//     title: 'The Road',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a road of build ',
//     categoryId: 1,
//     img: 'fant4.jpg'
// },
// {
//     id: 5,
//     title: 'Stevenson Jobson',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of',
//     categoryId: 1,
//     img: 'fant5.png'
// },
// {
//     id: 6,
//     title: 'The Road2',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a road of build ',
//     categoryId: 1,
//     img: 'fant4.jpg'
// },
// {
//     id: 7,
//     title: 'Stevenson Jobson 2',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of',
//     categoryId: 1,
//     img: 'fant5.png'
// },
// {
//     id: 8,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'det1.jpg'
// },
// {
//     id: 9,
//     title: 'Mockingjay: Final Games',
//     author: 'Suzanne Collins',
//     description: 'This road of build ',
//     categoryId: 1,
//     img: 'det2.jpg'
// },
// {
//     id: 10,
//     title: 'Jark Jarkoe',
//     author: 'Steven Sigal',
//     description: 'This book is about a great man, wdfjvbhfd dfbv dsrffgjk drfgbcf dgbdgbjf ',
//     categoryId: 1,
//     img: 'det3.jpg'
// },
// {
//     id: 11,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'det4.jpg'
// },
// {
//     id: 12,
//     title: 'Mockingjay: The Final Book of The Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 1,
//     img: 'det5.jpg'
// },
// {
//     id: 13,
//     title: ' The Final Book of The Hunger Games',
//     author: 'Grigore Vieru',
//     description: 'This is about a great man, who had a long road of build ',
//     categoryId: 2,
//     img: 'chil1.png'
// },
// {
//     id: 14,
//     title: 'Road Ahead',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 2,
//     img: 'chil2.jpg'
// },
// {
//     id: 15,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 2,
//     img: 'chil3.jpg'
// },
// {
//     id: 16,
//     title: 'Mockingjay: The Final Book of The Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 2,
//     img: 'chil4.jpg'
// },
// {
//     id: 17,
//     title: 'Bill Gates',
//     author: 'Road Ahead',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 2,
//     img: 'chil5.jpg'
// },
// {
//     id: 18,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 3,
//     img: 'det1.jpg'
// },
// {
//     id: 19,
//     title: 'Mockingjay: Final Games',
//     author: 'Suzanne Collins',
//     description: 'This road of build ',
//     categoryId: 3,
//     img: 'det2.jpg'
// },
// {
//     id: 20,
//     title: 'Jark Jarkoe',
//     author: 'Steven Sigal',
//     description: 'This book is about a great man, wdfjvbhfd dfbv dsrffgjk drfgbcf dgbdgbjf ',
//     categoryId: 3,
//     img: 'det3.jpg'
// },
// {
//     id: 21,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 3,
//     img: 'det4.jpg'
// },
// {
//     id: 22,
//     title: 'Mockingjay: The Final Book of The Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 3,
//     img: 'det5.jpg'
// },
// {
//     id: 23,
//     title: 'Bill Gates',
//     author: 'Road Ahead',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'hist1.jpg'
// },
// {
//     id: 24,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'hist2.jpg'
// },
// {
//     id: 25,
//     title: 'Mockingjay: The Final Book of The Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'hist3.jpg'
// },
// {
//     id: 26,
//     title: 'Alo alo',
//     author: 'Road Ahead',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'hist4.jpg'
// },
// {
//     id: 27,
//     title: 'Mark fgbf',
//     author: 'John Doe',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'hist5.jpg'
// },
// {
//     id: 28,
//     title: 'Road Ahead',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'fant1.jpg'
// },
// {
//     id: 29,
//     title: 'Steve Jobs',
//     author: 'Walter Isaacson',
//     description: 'This book  about a great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'fant2.jpg'
// },
// {
//     id: 30,
//     title: 'Hunger Games',
//     author: 'Suzanne Collins',
//     description: 'This book is about  great man, who had a long road of build ',
//     categoryId: 4,
//     img: 'fant3.jpg'
// },
// {
//     id: 31,
//     title: 'The Road',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a road of build ',
//     categoryId: 4,
//     img: 'fant4.jpg'
// },
// {
//     id: 32,
//     title: 'Stevenson Jobson',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of',
//     categoryId: 4,
//     img: 'fant5.png'
// },
// {
//     id: 33,
//     title: 'The Road2',
//     author: 'Bill Gates',
//     description: 'This book is about a great man, who had a road of build ',
//     categoryId: 4,
//     img: 'fant4.jpg'
// },
// {
//     id: 34,
//     title: 'Stevenson Jobson 2',
//     author: 'Walter Isaacson',
//     description: 'This book is about a great man, who had a long road of',
//     categoryId: 4,
//     img: 'fant5.png'
// }];


// Get arguments passed on command line
var userArgs = process.argv.slice(2);
/*
if (!userArgs[0].startsWith('mongodb')) {
    console.log('ERROR: You need to specify a valid mongodb URL as the first argument');
    return
}
*/
var async = require('async')
var Book = require('./models/book')
var Author = require('./models/author')
var Category = require('./models/category')

var mongoose = require('mongoose');
var mongoDB = userArgs[0];
mongoose.connect(mongoDB, { useNewUrlParser: true });
mongoose.Promise = global.Promise;
var db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection error:'));

var authors = [];
var categories = [];

function authorCreate(name,cb) {
    authordetail = { name: name }
    var author = new Author(authordetail);
    author.save(function (err) {
        if (err) {
            console.log(err)
            return
        }
        console.log('New Author: ' + author);
        authors.push(author)
        cb(null, author);
    });
}

function categoryCreate(title, name, id, cb) {
    var category = new Category({ title: title, name: name, id: id });
    category.save(function (err) {
        if (err) {
            console.log(err);
            return;
        }
        console.log('New Category: ' + category);
        categories.push(category)
        cb(null,category);
    });
}

function bookCreate(title, author, description, categoryId, img, id, cb) {
    bookdetail = {
        title: title,
        author: author,
        description: description,
        img: img,
        id: id
    }
    if (categoryId != false) bookdetail.categoryId = categoryId

    var book = new Book(bookdetail);
    book.save(function (err) {
        if (err) {
            console.log(err);
            return;
        }
        console.log('New Book: ' + book);
        // books.push(book)
        cb(null,book);
    });
}

function createCategoryAuthors(cb) {
    async.series([
        function (callback) {
            authorCreate('Bill Gates', callback);
        },
        function (callback) {
            authorCreate('Walter Isaacson', callback);
        },
        function (callback) {
            authorCreate('Suzanne Collins', callback);
        },
        function (callback) {
            authorCreate('John Doe', callback);
        },
        function (callback) {
            authorCreate('Grigore Vieru', callback);
        },
        function (callback) {
            authorCreate('Steven Sigal', callback);
        },
        function (callback) {
            categoryCreate("Fantasy", "fantasy", 1, callback);
        },
        function (callback) {
            categoryCreate("Children", "children", 2, callback);
        },
        function (callback) {
            categoryCreate("DetectiveStories", "detectivestories", 3, callback);
        },
        function (callback) {
            categoryCreate("History", "history", 4, callback);
        },
    ],
        cb);
}


function createBooks(cb) {
    async.parallel([
        function (callback) {
            bookCreate('Road Ahead', authors[0], 'This book is about a great man, who had a long road of build',categories[0], 'fant1.jpg', 1, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[0],'This book is about a great man, who had a long road of build', categories[0],'fant2.jpg', 2, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[1], 'This book is about a great man, who had a long road of build',categories[0], 'fant3.jpg', 3, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[1],'This book is about a great man, who had a long road of build', categories[0],'fant4.jpg', 4, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[3], 'This book is about a great man, who had a long road of build',categories[0], 'fant4.jpg', 5, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[1],'This book is about a great man, who had a long road of build', categories[0],'fant5.png', 6, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[2], 'This book is about a great man, who had a long road of build',categories[0], 'fant1.jpg', 7, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[2],'This book is about a great man, who had a long road of build', categories[0],'fant2.jpg', 8, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[2], 'This book is about a great man, who had a long road of build',categories[0], 'fant3.jpg', 9, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[2],'This book is about a great man, who had a long road of build', categories[0],'fant4.jpg', 10, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[2], 'This book is about a great man, who had a long road of build',categories[0], 'fant5.png', 11, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[3],'This book is about a great man, who had a long road of build', categories[0],'fant2.jpg', 12, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[3], 'This book is about a great man, who had a long road of build',categories[1], 'chil1.png', 13, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[4],'This book is about a great man, who had a long road of build', categories[1],'chil2.jpg', 14, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[4], 'This book is about a great man, who had a long road of build',categories[1], 'chil3.jpg', 15, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[4],'This book is about a great man, who had a long road of build', categories[1],'chil4.jpg', 16, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[4], 'This book is about a great man, who had a long road of build',categories[1], 'chil5.jpg',17, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[4],'This book is about a great man, who had a long road of build', categories[1],'chil1.png',18, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[5], 'This book is about a great man, who had a long road of build',categories[2], 'det1.jpg',19, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[5],'This book is about a great man, who had a long road of build', categories[2],'det2.jpg',20, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[5], 'This book is about a great man, who had a long road of build',categories[2], 'det3.jpg',21, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[5],'This book is about a great man, who had a long road of build', categories[2],'det4.jpg',22, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[5], 'This book is about a great man, who had a long road of build',categories[2], 'det5.jpg',23, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[5],'This book is about a great man, who had a long road of build', categories[2],'det1.jpg',24, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[3], 'This book is about a great man, who had a long road of build',categories[2], 'det5.jpg',25, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[3],'This book is about a great man, who had a long road of build', categories[2],'chil3.jpg',26, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[2], 'This book is about a great man, who had a long road of build',categories[2], 'chil4.jpg',27, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[3],'This book is about a great man, who had a long road of build', categories[2],'chil2.jpg',28, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[3], 'This book is about a great man, who had a long road of build',categories[3], 'det1.jpg',29, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[4],'This book is about a great man, who had a long road of build', categories[3],'det2.jpg',30, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[4], 'This book is about a great man, who had a long road of build',categories[3], 'fant1.jpg',31, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[4],'This book is about a great man, who had a long road of build', categories[3],'fant2.jpg',32, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[4], 'This book is about a great man, who had a long road of build',categories[3], 'hist2.jpg',33, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[1],'This book is about a great man, who had a long road of build', categories[3],'fant2.jpg',34, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[1], 'This book is about a great man, who had a long road of build',categories[3], 'hist1.jpg',35, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[1],'This book is about a great man, who had a long road of build', categories[3],'hist5.jpg',36, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[0], 'This book is about a great man, who had a long road of build',categories[3], 'hist4.jpg',37, callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[1],'This book is about a great man, who had a long road of build', categories[3],'hist3.jpg',38, callback);
        },
        function (callback) {
            bookCreate('Road Ahead', authors[2], 'This book is about a great man, who had a long road of build',categories[3], 'hist1.jpg', 39,callback);
        },
        function (callback) {
            bookCreate('Steve Jobs',authors[3],'This book is about a great man, who had a long road of build', categories[3],'hist2.jpg', 40,callback);
        },
    ],
        // optional callback
        cb);
}

async.series([
    createCategoryAuthors,
    createBooks,
],// Optional callback
function(err, results) {
    if (err) {
        console.log('FINAL ERR: '+err);
    }
    else {
        console.log('BOOKInstances');
        
    }
});